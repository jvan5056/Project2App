const Course = require('../models/course')

// let getAll = (req, res) =>{
//     res.render('/views/courses', {
//         course: courses.getAll()
//     })
// }


//create and show new course
let newCourse = (req,res) => {
    res.render('newCourse')
}

let createCourse = (req, res) =>{
    let newCourse = new Course(req.body)
    newCourse.save(() => console.log('New course was saved'))
    res.redirect('/classroom')
}

//show each course
let index = async (req, res) =>{
    let allCourses = await Course.find({});
    res.render('index', {allCourses})
}

let showCourse = (req,res) => {
    Course.findById(req.params.id).then((course) =>{
        console.log(course)
        res.render('courseDetail', {course})
    })
}

//update a course
let updateCourse = (req,res) => {
    console.log('update function ran');
    console.log(req.params.id);
    console.log(req.body);
    Course.findByIdAndUpdate(req.params.id, req.body).then((course) =>{
        res.redirect(`/classroom/${req.params.id}`)
    })
    res.redirect(`/classroom/${req.params.id}`);
 }

//delete a course
let deleteCourse = (req,res) => {
    console.log('delete function ran!')
    Course.deleteById(req.params.id)
    res.redirect('/classroom')
}


module.exports = {
    newCourse,
    createCourse,
    index,
    showCourse,
    updateCourse,
    deleteCourse
}
